<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>COBI.js demo</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />
    <link href="css/style.css" rel="stylesheet" />
</head>
<body>

<div id="language">
    <p>Waiting for language update</p>
</div>

<div id="navigationstatus">
    <p>Waiting for navigation status</p>
</div>

<div id="location">
    <p>Waiting for location update</p>
</div>

<div id="destination">
    <p>Waiting for destination update</p>
</div>

<div id="eta">
    <p>Waiting for eta update</p>
</div>

<div id="distance">
    <p>Waiting for distance update</p>
</div>

<div id="speed">
    <p>Waiting for speed update</p>
</div>

  <div id="heartrate">
    <p>Waiting for heartrate update</p>
</div>

  <div id="userpower">
    <p>Waiting for userpower update</p>
</div>

    <div id="contact">
    <p>Waiting for contact update</p>
</div>

    <div id="cadence">
    <p>Waiting for cadence update</p>
</div>

<div id="thumbcontroller">
    <p>Waiting for thumbcontroller update</p>
</div>

<div id="supportedversion">
    <p>Waiting for supportedversion update</p>
</div>

<div id="touchinteraction">
    <p>Waiting for touch interaction update</p>
</div>

<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
<script src="https://cdn.cobi.bike/cobi.js/latest/cobi.js"></script>
<script>

COBI.init("access-token")

COBI.app.language.subscribe(function(language) {
    $('#language').html(`<p> New language: ${language} </p>`);
});

COBI.mobile.location.subscribe(function(location) {
    $('#location').html(`<p> New location {lat: ${location.latitude}, lon: ${location.longitude}} </p>`);
});

COBI.navigationService.status.subscribe(function(navigationStatus) {
  $('#navigationstatus').html(`<p> Navigation status: ${navigationStatus}</p>`);
});

COBI.navigationService.destinationLocation.subscribe(function(navigation) {
  $('#destination').html(`<p> New destination: (lat: ${navigation.latitude}, lon: ${navigation.longitude})</p>`);
});

COBI.navigationService.eta.subscribe(function(eta) {
  var etaDate = new Date(eta * 1000);
  $('#eta').html(`<p> New eta: ${etaDate}</p>`);
});

COBI.navigationService.distanceToDestination.subscribe(function(distance) {
  $('#distance').html(`<p> New distance: ${distance} m</p>`);
});

COBI.hub.externalInterfaceAction.subscribe(function(action) {
  $('#thumbcontroller').html(`<p> New thumb controller action : ${action} </p>`);
});

COBI.intelligenceService.speed.subscribe(function(value) {
  $('#speed').html(`<p> current speed: ${value} </p>`);
});

COBI.intelligenceService.userPower.subscribe(function(value) {
  $('#userpower').html(`<p> current user power: ${value} </p>`);
});

COBI.intelligenceService.heartRate.subscribe(function(value) {
  $('#heartRate').html(`<p> current heartrate: ${value} </p>`);
})

COBI.intelligenceService.cadence.subscribe(function(value) {
  $('#cadence').html(`<p> current cadence: ${value} </p>`);
})

COBI.app.touchInteractionEnabled.subscribe(function(enabled) {
  $('#touchinteraction').html(`<p> touch interaction: ${enabled} </p>`);
})

COBI.app.contact.subscribe(function(contact) {
  $('#contact').html(`<p> contact: <a href="tel:${contact.phone}">${contact.phone}</a> </p>`);
})

COBI.navigationService.destinationLocation.write({"latitude": 50.110924,
                                                  "longitude": 8.682127,
                                                  "altitude": 0,
                                                  "bearing": 0,
                                                  "speed": 0,
                                                  "horizontalAccuracy": 0,
                                                  "verticalAccuracy": 0})

COBI.app.textToSpeech.write({"content" : "Hello Camilo", "locale" : "en-US"})
COBI.app.readLater.write({"title" : "COBI", "url" : "https://cobi.bike"})
COBI.app.contact.read()

</script>

</body>
</html>
